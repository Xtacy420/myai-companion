(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{1414:(e,t,a)=>{"use strict";e.exports=a(2436)},2436:(e,t,a)=>{"use strict";var r=a(2115),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=r.useState,l=r.useEffect,i=r.useLayoutEffect,o=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!s(e,a)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),r=n({inst:{value:a,getSnapshot:t}}),s=r[0].inst,d=r[1];return i(function(){s.value=a,s.getSnapshot=t,c(s)&&d({inst:s})},[e,a,t]),l(function(){return c(s)&&d({inst:s}),e(function(){c(s)&&d({inst:s})})},[e]),o(a),a};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:d},3042:(e,t,a)=>{"use strict";a.d(t,{eu:()=>Y,q5:()=>F,BK:()=>k});var r=a(5853),s=a(2115),n=a(6081),l=a(9033),i=a(2712),o=a(3655),c=a(1414);function d(){return()=>{}}var u=a(5155),h="Avatar",[m,p]=(0,n.A)(h),[f,v]=m(h),g=s.forwardRef((e,t)=>{let{__scopeAvatar:a,...r}=e,[n,l]=s.useState("idle");return(0,u.jsx)(f,{scope:a,imageLoadingStatus:n,onImageLoadingStatusChange:l,children:(0,u.jsx)(o.sG.span,{...r,ref:t})})});g.displayName=h;var y="AvatarImage",w=s.forwardRef((e,t)=>{let{__scopeAvatar:a,src:r,onLoadingStatusChange:n=()=>{},...h}=e,m=v(y,a),p=function(e,t){let{referrerPolicy:a,crossOrigin:r}=t,n=(0,c.useSyncExternalStore)(d,()=>!0,()=>!1),l=s.useRef(null),o=n?(l.current||(l.current=new window.Image),l.current):null,[u,h]=s.useState(()=>N(o,e));return(0,i.N)(()=>{h(N(o,e))},[o,e]),(0,i.N)(()=>{let e=e=>()=>{h(e)};if(!o)return;let t=e("loaded"),s=e("error");return o.addEventListener("load",t),o.addEventListener("error",s),a&&(o.referrerPolicy=a),"string"==typeof r&&(o.crossOrigin=r),()=>{o.removeEventListener("load",t),o.removeEventListener("error",s)}},[o,r,a]),u}(r,h),f=(0,l.c)(e=>{n(e),m.onImageLoadingStatusChange(e)});return(0,i.N)(()=>{"idle"!==p&&f(p)},[p,f]),"loaded"===p?(0,u.jsx)(o.sG.img,{...h,ref:t,src:r}):null});w.displayName=y;var x="AvatarFallback",b=s.forwardRef((e,t)=>{let{__scopeAvatar:a,delayMs:r,...n}=e,l=v(x,a),[i,c]=s.useState(void 0===r);return s.useEffect(()=>{if(void 0!==r){let e=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(e)}},[r]),i&&"loaded"!==l.imageLoadingStatus?(0,u.jsx)(o.sG.span,{...n,ref:t}):null});function N(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}b.displayName=x;var C=a(9434);let Y=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(g,{ref:t,className:(0,C.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});Y.displayName=g.displayName;let k=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(w,{ref:t,className:(0,C.cn)("aspect-square h-full w-full",a),...s})});k.displayName=w.displayName;let F=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(b,{ref:t,className:(0,C.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});F.displayName=b.displayName},4165:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>h,L3:()=>p,c7:()=>m,lG:()=>o,zM:()=>c});var r=a(5853),s=a(2115),n=a(5452),l=a(5318),i=a(9434);let o=n.bL,c=n.l9,d=n.ZL;n.bm;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});u.displayName=n.hJ.displayName;let h=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.FD)(d,{children:[(0,r.Y)(u,{}),(0,r.FD)(n.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[s,(0,r.FD)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.Y)(l.A,{className:"h-4 w-4"}),(0,r.Y)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=n.UC.displayName;let m=e=>{let{className:t,...a}=e;return(0,r.Y)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});p.displayName=n.hE.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})}).displayName=n.VY.displayName},5074:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},5222:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]])},5300:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},6273:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]])},6424:(e,t,a)=>{"use strict";a.d(t,{F:()=>i});var r=a(5853),s=a(2115),n=a(7655),l=a(9434);let i=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,r.FD)(n.bL,{ref:t,className:(0,l.cn)("relative overflow-hidden",a),...i,children:[(0,r.Y)(n.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.Y)(o,{}),(0,r.Y)(n.OK,{})]})});i.displayName=n.bL.displayName;let o=s.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...i}=e;return(0,r.Y)(n.VM,{ref:t,orientation:s,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,r.Y)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=n.VM.displayName},6880:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Q});var r=a(5853),s=a(2115),n=a(285),l=a(2523),i=a(6424),o=a(8539),c=a(3042),d=a(6126),u=a(8186),h=a(207),m=a(8224),p=a(1920),f=a(1721),v=a(5074),g=a(286),y=a(5300),w=a(8046),x=a(157);let b=(0,x.A)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);var N=a(4601),C=a(965),Y=a(3158),k=a(8271),F=a(172);let D=(0,x.A)("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);var A=a(6273);let S=(0,x.A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var E=a(1255),M=a(2956);class j{static getInstance(){return j.instance||(j.instance=new j),j.instance}async createConversation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"New Conversation",a={id:this.generateConversationId(),userId:e,title:t,messages:[],createdAt:Date.now(),updatedAt:Date.now()};return await M.EC.createConversation(a),a}async getConversationById(e){return await M.EC.getConversationById(e)||null}async getConversationsByUser(e){return await M.EC.getConversationsByUser(e)}async addMessageToConversation(e,t,a){let r=await this.getConversationById(e);if(!r)throw Error("Conversation not found");let s={role:t,content:a,timestamp:Date.now()};r.messages.push(s),r.updatedAt=Date.now(),1===r.messages.length&&"user"===t&&(r.title=a.slice(0,50)+(a.length>50?"...":"")),await M.EC.updateConversation(e,{title:r.title,messages:r.messages,updatedAt:r.updatedAt})}async updateConversationTitle(e,t){await M.EC.updateConversation(e,{title:t,updatedAt:Date.now()})}async deleteConversation(e){await M.EC.deleteConversation(e)}async searchConversations(e,t){return await M.EC.searchConversations(e,t)}async getConversationStats(e){let t=await this.getConversationsByUser(e),a=t.length,r=t.reduce((e,t)=>e+t.messages.length,0);return{totalConversations:a,totalMessages:r,averageMessagesPerConversation:Math.round(10*(a>0?r/a:0))/10}}async createSummaryConversation(e,t,a){let r=await this.createConversation(e,"".concat(t.title," (Continued)"));return await this.addMessageToConversation(r.id,"assistant","Previous conversation summary: ".concat(a)),r}async isConversationTooLong(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=await this.getConversationById(e);if(!a)return{isLong:!1,isCritical:!1,messageCount:0};let r=a.messages.length;return{isLong:r>=Math.floor(.8*t),isCritical:r>=t,messageCount:r}}async getRecentConversations(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await this.getConversationsByUser(e)).slice(0,t)}async exportConversations(e){return JSON.stringify(await this.getConversationsByUser(e),null,2)}async importConversations(e,t){try{let a=JSON.parse(t),r=0;for(let t of a)if(!await this.getConversationById(t.id)){let a={...t,userId:e};await M.EC.createConversation(a),r++}return r}catch(e){throw Error("Invalid conversation data format")}}generateConversationId(){return"conv_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}constructor(){}}let I=j.getInstance();async function R(e){try{let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"user",content:e}]})});if(t.ok)return(await t.json()).message}catch(e){console.error("AI response generation failed:",e)}let t=["I understand what you're saying. Could you tell me more about that?","That's interesting! How does that make you feel?","I'm here to help you process your thoughts. What's most important to you about this?","Thank you for sharing that with me. What would you like to explore next?","I appreciate you opening up. How can I support you with this?"];return t[Math.floor(Math.random()*t.length)]}var L=a(6874),T=a.n(L),z=a(9053),P=a(6695),B=a(5057),$=a(4165),q=a(9409);let U=(0,x.A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var J=a(5222),O=a(7223);let W=[{value:"friendly",label:"Friendly",description:"Warm and approachable"},{value:"professional",label:"Professional",description:"Formal and business-like"},{value:"casual",label:"Casual",description:"Relaxed and informal"},{value:"enthusiastic",label:"Enthusiastic",description:"Energetic and excited"},{value:"analytical",label:"Analytical",description:"Logical and detail-oriented"},{value:"empathetic",label:"Empathetic",description:"Understanding and supportive"},{value:"witty",label:"Witty",description:"Clever and humorous"},{value:"wise",label:"Wise",description:"Thoughtful and experienced"}],H=[{value:"conversational",label:"Conversational",description:"Natural dialogue"},{value:"detailed",label:"Detailed",description:"Comprehensive responses"},{value:"concise",label:"Concise",description:"Brief and to the point"},{value:"creative",label:"Creative",description:"Imaginative and original"},{value:"supportive",label:"Supportive",description:"Encouraging and helpful"},{value:"inquisitive",label:"Inquisitive",description:"Asks thoughtful questions"}],V=["Intelligent","Curious","Patient","Creative","Logical","Intuitive","Optimistic","Realistic","Adventurous","Cautious","Independent","Collaborative","Analytical","Emotional","Practical","Idealistic","Confident","Humble"],K=["Psychology","Philosophy","Science","Technology","Art","Literature","History","Business","Health","Fitness","Cooking","Music","Education","Relationships","Career","Finance","Travel","Gaming"],_=["\uD83E\uDD16","\uD83D\uDC68‍\uD83D\uDCBC","\uD83D\uDC69‍\uD83D\uDD2C","\uD83D\uDC68‍\uD83C\uDFA8","\uD83D\uDC69‍\uD83D\uDCBB","\uD83D\uDC68‍\uD83C\uDFEB","\uD83D\uDC69‍⚕️","\uD83E\uDDD9‍♂️","\uD83E\uDDD9‍♀️","\uD83D\uDC68‍\uD83C\uDF73","\uD83D\uDC69‍\uD83C\uDFA4","\uD83E\uDDB8‍♂️","\uD83E\uDDB8‍♀️","\uD83D\uDC68‍\uD83D\uDE80","\uD83D\uDC69‍\uD83D\uDE80"];function G(e){let{onCharacterSelect:t,selectedCharacterId:a}=e,[c,u]=(0,s.useState)([]),[h,p]=(0,s.useState)(!0),[f,v]=(0,s.useState)(!1),[g,y]=(0,s.useState)(null),{userId:x}=(0,E.a)(),[N,C]=(0,s.useState)({name:"",description:"",personality:{traits:[],tone:"friendly",expertise:[],responseStyle:"conversational"},avatar:"\uD83E\uDD16",backstory:""}),[Y,k]=(0,s.useState)(""),[F,D]=(0,s.useState)("");(0,s.useEffect)(()=>{x&&A()},[x]);let A=async()=>{if(x)try{let e=await M.EC.getCharactersByUser(x);u(e)}catch(e){console.error("Failed to load characters:",e)}finally{p(!1)}},S=()=>{C({name:"",description:"",personality:{traits:[],tone:"friendly",expertise:[],responseStyle:"conversational"},avatar:"\uD83E\uDD16",backstory:""}),k(""),D("")},j=e=>{y(e),C({name:e.name,description:e.description,personality:{...e.personality},avatar:e.avatar||"\uD83E\uDD16",backstory:e.backstory||""}),v(!0)},I=async()=>{if(x&&N.name.trim())try{let e={id:(null==g?void 0:g.id)||M.EC.generateId(),userId:x,name:N.name.trim(),description:N.description.trim(),personality:N.personality,avatar:N.avatar,backstory:N.backstory.trim()||void 0,conversationCount:(null==g?void 0:g.conversationCount)||0,isActive:!0,createdAt:(null==g?void 0:g.createdAt)||Date.now(),updatedAt:Date.now()};g?await M.EC.updateCharacter(g.id,e):await M.EC.createCharacter(e),await A(),v(!1),y(null),S()}catch(e){console.error("Failed to save character:",e)}},R=async e=>{if(confirm("Are you sure you want to delete this character? This will also delete all conversations with this character."))try{await M.EC.deleteCharacter(e),await A(),a===e&&(null==t||t(null))}catch(e){console.error("Failed to delete character:",e)}},L=(e,t,a)=>{if(!t.trim())return;let r=N.personality[e];r.includes(t.trim())||C(a=>({...a,personality:{...a.personality,[e]:[...r,t.trim()]}})),a("")},T=(e,t)=>{let a=N.personality[e];C(r=>({...r,personality:{...r.personality,[e]:a.filter((e,a)=>a!==t)}}))},z=(e,t)=>{let a=N.personality[e];a.includes(t)?C(r=>({...r,personality:{...r.personality,[e]:a.filter(e=>e!==t)}})):C(r=>({...r,personality:{...r.personality,[e]:[...a,t]}}))};return h?(0,r.Y)("div",{className:"flex items-center justify-center py-4",children:(0,r.FD)("div",{className:"text-center",children:[(0,r.Y)(b,{className:"w-6 h-6 mx-auto mb-2 text-slate-400 animate-pulse"}),(0,r.Y)("p",{className:"text-xs text-slate-500",children:"Loading characters..."})]})}):(0,r.FD)("div",{className:"space-y-3",children:[(0,r.FD)($.lG,{open:f,onOpenChange:v,children:[(0,r.Y)($.zM,{asChild:!0,children:(0,r.FD)(n.$,{variant:"outline",className:"w-full gap-2",onClick:()=>{y(null),S()},children:[(0,r.Y)(w.A,{className:"w-3 h-3"}),"Create Character"]})}),(0,r.FD)($.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.Y)($.c7,{children:(0,r.Y)($.L3,{children:g?"Edit Character":"Create New Character"})}),(0,r.FD)("div",{className:"space-y-6",children:[(0,r.FD)("div",{className:"grid grid-cols-1 gap-4",children:[(0,r.FD)("div",{children:[(0,r.Y)(B.J,{htmlFor:"name",children:"Character Name"}),(0,r.Y)(l.p,{id:"name",placeholder:"e.g., Dr. Sarah, Coach Mike, Zen Master...",value:N.name,onChange:e=>C(t=>({...t,name:e.target.value}))})]}),(0,r.FD)("div",{children:[(0,r.Y)(B.J,{htmlFor:"description",children:"Description"}),(0,r.Y)(l.p,{id:"description",placeholder:"Brief description of the character...",value:N.description,onChange:e=>C(t=>({...t,description:e.target.value}))})]}),(0,r.FD)("div",{children:[(0,r.Y)(B.J,{children:"Avatar"}),(0,r.Y)("div",{className:"flex flex-wrap gap-2 mt-1",children:_.map(e=>(0,r.Y)(n.$,{variant:N.avatar===e?"default":"outline",className:"w-10 h-10 p-0 text-lg",onClick:()=>C(t=>({...t,avatar:e})),children:e},e))})]})]}),(0,r.FD)("div",{className:"space-y-4",children:[(0,r.Y)("h3",{className:"font-semibold",children:"Personality"}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{children:[(0,r.Y)(B.J,{children:"Tone"}),(0,r.FD)(q.l6,{value:N.personality.tone,onValueChange:e=>C(t=>({...t,personality:{...t.personality,tone:e}})),children:[(0,r.Y)(q.bq,{children:(0,r.Y)(q.yv,{})}),(0,r.Y)(q.gC,{children:W.map(e=>(0,r.Y)(q.eb,{value:e.value,children:(0,r.FD)("div",{children:[(0,r.Y)("div",{className:"font-medium",children:e.label}),(0,r.Y)("div",{className:"text-xs text-slate-500",children:e.description})]})},e.value))})]})]}),(0,r.FD)("div",{children:[(0,r.Y)(B.J,{children:"Response Style"}),(0,r.FD)(q.l6,{value:N.personality.responseStyle,onValueChange:e=>C(t=>({...t,personality:{...t.personality,responseStyle:e}})),children:[(0,r.Y)(q.bq,{children:(0,r.Y)(q.yv,{})}),(0,r.Y)(q.gC,{children:H.map(e=>(0,r.Y)(q.eb,{value:e.value,children:(0,r.FD)("div",{children:[(0,r.Y)("div",{className:"font-medium",children:e.label}),(0,r.Y)("div",{className:"text-xs text-slate-500",children:e.description})]})},e.value))})]})]})]}),(0,r.FD)("div",{children:[(0,r.Y)(B.J,{children:"Personality Traits"}),(0,r.FD)("div",{className:"flex gap-2 mt-1",children:[(0,r.Y)(l.p,{placeholder:"Add a trait...",value:Y,onChange:e=>k(e.target.value),onKeyDown:e=>"Enter"===e.key&&L("traits",Y,k)}),(0,r.Y)(n.$,{type:"button",variant:"outline",onClick:()=>L("traits",Y,k),children:"Add"})]}),(0,r.Y)("div",{className:"flex flex-wrap gap-1 mt-2",children:V.map(e=>(0,r.Y)(d.E,{variant:N.personality.traits.includes(e)?"default":"outline",className:"cursor-pointer text-xs",onClick:()=>z("traits",e),children:e},e))}),N.personality.traits.length>0&&(0,r.Y)("div",{className:"flex flex-wrap gap-1 mt-2",children:N.personality.traits.map((e,t)=>(0,r.FD)(d.E,{variant:"secondary",className:"gap-1",children:[e,(0,r.Y)("button",{onClick:()=>T("traits",t),children:"\xd7"})]},t))})]}),(0,r.FD)("div",{children:[(0,r.Y)(B.J,{children:"Areas of Expertise"}),(0,r.FD)("div",{className:"flex gap-2 mt-1",children:[(0,r.Y)(l.p,{placeholder:"Add expertise area...",value:F,onChange:e=>D(e.target.value),onKeyDown:e=>"Enter"===e.key&&L("expertise",F,D)}),(0,r.Y)(n.$,{type:"button",variant:"outline",onClick:()=>L("expertise",F,D),children:"Add"})]}),(0,r.Y)("div",{className:"flex flex-wrap gap-1 mt-2",children:K.map(e=>(0,r.Y)(d.E,{variant:N.personality.expertise.includes(e)?"default":"outline",className:"cursor-pointer text-xs",onClick:()=>z("expertise",e),children:e},e))}),N.personality.expertise.length>0&&(0,r.Y)("div",{className:"flex flex-wrap gap-1 mt-2",children:N.personality.expertise.map((e,t)=>(0,r.FD)(d.E,{variant:"secondary",className:"gap-1",children:[e,(0,r.Y)("button",{onClick:()=>T("expertise",t),children:"\xd7"})]},t))})]})]}),(0,r.FD)("div",{children:[(0,r.Y)(B.J,{htmlFor:"backstory",children:"Backstory (Optional)"}),(0,r.Y)(o.T,{id:"backstory",placeholder:"Give your character a background story, context, or specific role...",value:N.backstory,onChange:e=>C(t=>({...t,backstory:e.target.value})),rows:3})]}),(0,r.FD)("div",{className:"flex gap-4 pt-4",children:[(0,r.Y)(n.$,{onClick:I,className:"flex-1",disabled:!N.name.trim(),children:g?"Update Character":"Create Character"}),(0,r.Y)(n.$,{variant:"outline",onClick:()=>{v(!1),y(null),S()},children:"Cancel"})]})]})]})]}),(0,r.Y)("div",{className:"space-y-2",children:0===c.length?(0,r.FD)("div",{className:"text-center py-6",children:[(0,r.Y)(b,{className:"w-8 h-8 mx-auto mb-2 text-slate-300"}),(0,r.Y)("p",{className:"text-xs text-slate-500 mb-2",children:"No characters yet"}),(0,r.FD)(n.$,{variant:"ghost",size:"sm",onClick:()=>v(!0),className:"gap-1 text-xs",children:[(0,r.Y)(U,{className:"w-3 h-3"}),"Create your first character"]})]}):(0,r.Y)(i.F,{className:"max-h-64",children:(0,r.Y)("div",{className:"space-y-2",children:c.map(e=>(0,r.Y)(P.Zp,{className:"cursor-pointer transition-colors hover:bg-slate-50 ".concat(a===e.id?"ring-2 ring-blue-500 bg-blue-50":""),onClick:()=>null==t?void 0:t(e.id),children:(0,r.Y)(P.Wu,{className:"p-3",children:(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,r.Y)("span",{className:"text-lg",children:e.avatar}),(0,r.FD)("div",{className:"flex-1 min-w-0",children:[(0,r.Y)("div",{className:"font-medium text-sm truncate",children:e.name}),(0,r.Y)("div",{className:"text-xs text-slate-500 truncate",children:e.description}),(0,r.FD)("div",{className:"flex items-center gap-1 mt-1",children:[(0,r.Y)(d.E,{variant:"outline",className:"text-xs",children:e.personality.tone}),e.conversationCount>0&&(0,r.FD)(d.E,{variant:"secondary",className:"text-xs gap-1",children:[(0,r.Y)(m.A,{className:"w-2 h-2"}),e.conversationCount]})]})]})]}),(0,r.FD)("div",{className:"flex gap-1",children:[(0,r.Y)(n.$,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:t=>{t.stopPropagation(),j(e)},children:(0,r.Y)(J.A,{className:"w-3 h-3"})}),(0,r.Y)(n.$,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-red-500 hover:text-red-700",onClick:t=>{t.stopPropagation(),R(e.id)},children:(0,r.Y)(O.A,{className:"w-3 h-3"})})]})]})})},e.id))})})}),a&&(0,r.FD)(n.$,{variant:"ghost",size:"sm",onClick:()=>null==t?void 0:t(null),className:"w-full gap-2 text-slate-500",children:[(0,r.Y)(b,{className:"w-3 h-3"}),"Switch to MyAi Assistant"]})]})}function Z(){let[e,t]=(0,s.useState)(""),[a,x]=(0,s.useState)(!0),[j,L]=(0,s.useState)(""),[z,P]=(0,s.useState)("regular"),[B,$]=(0,s.useState)(null),[q,U]=(0,s.useState)([]),[J,O]=(0,s.useState)(null),[W,H]=(0,s.useState)([]),[V,K]=(0,s.useState)(!1),{userId:_,user:Z}=(0,E.a)(),{currentConversation:Q,sendMessage:X,isLoading:ee,conversations:et,currentConversationId:ea,setCurrentConversationId:er,isConversationTooLong:es,isConversationCritical:en,showChatTooLongWarning:el,createNewChatWithSummary:ei,isCreatingNewChat:eo,messageCount:ec,maxMessages:ed}=function(e){var t;let[a,r]=(0,s.useState)([]),[n,l]=(0,s.useState)(null),[i,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)(!1),[m]=(0,s.useState)(100),p=(null==n||null==(t=n.messages)?void 0:t.length)||0,f=p>=Math.floor(.8*m),v=p>=m,g=f&&!v;(0,s.useEffect)(()=>{e?y():(r([]),l(null),o(null))},[e]),(0,s.useEffect)(()=>{i&&w()},[i]);let y=(0,s.useCallback)(async()=>{if(e)try{let t=await I.getConversationsByUser(e);r(t),!i&&t.length>0&&o(t[0].id)}catch(e){console.error("Failed to load conversations:",e)}},[e,i]),w=(0,s.useCallback)(async()=>{if(i)try{let e=await I.getConversationById(i);l(e)}catch(e){console.error("Failed to load current conversation:",e)}},[i]),x=(0,s.useCallback)(async t=>{if(e&&t.trim()){d(!0);try{let a=i;a||(a=(await I.createConversation(e)).id,o(a),await y()),await I.addMessageToConversation(a,"user",t);let r=await R(t);await I.addMessageToConversation(a,"assistant",r),await w(),await y()}catch(e){console.error("Failed to send message:",e)}finally{d(!1)}}},[e,i,y,w]),b=(0,s.useCallback)(async()=>{if(e){h(!0);try{let t=await I.createConversation(e);o(t.id),await y()}catch(e){console.error("Failed to create new chat:",e)}finally{h(!1)}}},[e,y]),N=(0,s.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e&&n)if(t||v){h(!0);try{let t=function(e){let t=e.messages.length,a=e.messages.filter(e=>"user"===e.role),r=e.messages.slice(-6),s=a.slice(-10).map(e=>e.content).join(" ").toLowerCase(),n="Previous conversation (".concat(t," messages): ");(s.includes("work")||s.includes("job"))&&(n+="We discussed work and career topics. "),(s.includes("family")||s.includes("relationship"))&&(n+="We talked about family and relationships. "),(s.includes("feeling")||s.includes("emotion"))&&(n+="We explored feelings and emotions. "),(s.includes("goal")||s.includes("plan"))&&(n+="We discussed goals and future plans. ");let l=r.filter(e=>"user"===e.role).slice(-2).map(e=>e.content.slice(0,100)).join(" | ");return l&&(n+="Recent topics: ".concat(l)),n.trim()}(n),a=await I.createSummaryConversation(e,n,t);o(a.id),await y()}catch(e){console.error("Failed to create new chat with summary:",e)}finally{h(!1)}}else await b()},[e,n,v,b]),C=(0,s.useCallback)(async e=>{try{await I.deleteConversation(e),e===i&&(o(null),l(null)),await y()}catch(e){console.error("Failed to delete conversation:",e)}},[i,y]),Y=(0,s.useCallback)(async t=>{if(!e)return[];try{return await I.searchConversations(e,t)}catch(e){return console.error("Failed to search conversations:",e),[]}},[e]),k=(0,s.useCallback)(async()=>{if(!e)throw Error("No user logged in");try{return await I.exportConversations(e)}catch(e){throw console.error("Failed to export conversations:",e),e}},[e]);return{conversations:a,currentConversation:n,currentConversationId:i,isLoading:c,isCreatingNewChat:u,messageCount:p,maxMessages:m,isConversationTooLong:f,isConversationCritical:v,showChatTooLongWarning:g,sendMessage:x,createNewChat:b,createNewChatWithSummary:N,setCurrentConversationId:o,deleteConversation:C,searchConversations:Y,exportConversations:k,importConversations:(0,s.useCallback)(async t=>{if(!e)throw Error("No user logged in");try{let a=await I.importConversations(e,t);return await y(),a}catch(e){throw console.error("Failed to import conversations:",e),e}},[e,y]),getConversationStats:(0,s.useCallback)(async()=>{if(!e)return null;try{return await I.getConversationStats(e)}catch(e){return console.error("Failed to get conversation stats:",e),null}},[e])}}(_),{isListening:eu,isSupported:eh,interimTranscript:em,toggleListening:ep}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,a]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[l,i]=(0,s.useState)(""),[o,c]=(0,s.useState)(""),[d,u]=(0,s.useState)(null),h=(0,s.useRef)(null),m=(0,s.useRef)(e);(0,s.useEffect)(()=>{m.current=e},[e]),(0,s.useEffect)(()=>{var t,r;let s=window.SpeechRecognition||window.webkitSpeechRecognition;if(!s)return void n(!1);n(!0);let l=new s;return l.continuous=null!=(t=e.continuous)&&t,l.interimResults=null==(r=e.interimResults)||r,l.lang=e.language||"en-US",l.onstart=()=>{var e,t;a(!0),u(null),i(""),c(""),null==(e=(t=m.current).onStart)||e.call(t)},l.onresult=e=>{var t,a,r,s;let n="",l="";for(let t=e.resultIndex;t<e.results.length;t++){let a=e.results[t],r=a[0].transcript;a.isFinal?n+=r:l+=r}n&&(i(n),null==(t=(a=m.current).onResult)||t.call(a,n)),l&&(c(l),null==(r=(s=m.current).onInterimResult)||r.call(s,l))},l.onend=()=>{var e,t;a(!1),c(""),null==(e=(t=m.current).onEnd)||e.call(t)},l.onerror=e=>{var t,r;a(!1),u(e.error),null==(t=(r=m.current).onError)||t.call(r,e.error)},h.current=l,()=>{h.current&&h.current.abort()}},[e.continuous,e.interimResults,e.language]);let p=(0,s.useCallback)(()=>{if(h.current&&!t)try{h.current.start()}catch(e){console.error("Error starting speech recognition:",e),u("Failed to start speech recognition")}},[t]),f=(0,s.useCallback)(()=>{if(h.current&&t)try{h.current.stop()}catch(e){console.error("Error stopping speech recognition:",e)}},[t]),v=(0,s.useCallback)(()=>{t?f():p()},[t,p,f]);return{isListening:t,isSupported:r,transcript:l,interimTranscript:o,error:d,startListening:p,stopListening:f,toggleListening:v,resetTranscript:(0,s.useCallback)(()=>{i(""),c("")},[])}}({onResult:e=>{let a=e.trim();a&&t(a)},onEnd:()=>{setTimeout(()=>{e.trim()&&ey()},500)}});(0,s.useEffect)(()=>{_&&ef()},[_]),(0,s.useEffect)(()=>{B?(ev(),eg()):(O(null),H([]))},[B]);let ef=async()=>{if(_)try{let e=await M.EC.getCharactersByUser(_);U(e)}catch(e){console.error("Failed to load characters:",e)}},ev=async()=>{if(B)try{let e=await M.EC.getCharacterById(B);O(e||null)}catch(e){console.error("Failed to load selected character:",e)}},eg=async()=>{if(B)try{let e=await M.EC.getCharacterConversations(B);H(e)}catch(e){console.error("Failed to load character conversations:",e)}},ey=async()=>{if(e.trim()){if("regular"===z){if(!X)return;if(en)return void await ei(!0);await X(e),t("")}else if("character"===z&&B&&J){K(!0);try{let a;if(W&&W.length>0)a=W[0];else{let e={id:M.EC.generateId(),userId:_,characterId:B,title:"Chat with ".concat(J.name),messages:[],createdAt:Date.now(),updatedAt:Date.now()};await M.EC.createCharacterConversation(e),a=e}let r={role:"user",content:e,timestamp:Date.now()};a.messages.push(r);let s=await ew(e,J),n={role:"assistant",content:s,timestamp:Date.now()};a.messages.push(n),await M.EC.updateCharacterConversation(a.id,{messages:a.messages,updatedAt:Date.now()}),await M.EC.updateCharacter(B,{conversationCount:J.conversationCount+1,updatedAt:Date.now()}),await eg(),await ev(),t("")}catch(e){console.error("Error in character chat:",e)}finally{K(!1)}}}},ew=async(e,t)=>{if(!t)return"I'm here to help you!";let a="You are ".concat(t.name,", ").concat(t.description,".\n\nPersonality:\n- Tone: ").concat(t.personality.tone,"\n- Response Style: ").concat(t.personality.responseStyle,"\n- Traits: ").concat(t.personality.traits.join(", "),"\n- Expertise: ").concat(t.personality.expertise.join(", "),"\n\n").concat(t.backstory?"Background: ".concat(t.backstory):"","\n\nRespond to the user's message in character, keeping your personality consistent. Be helpful, engaging, and true to your character traits.\n\nUser message: ").concat(e);try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"user",content:a}],character:t.name})});if(e.ok)return(await e.json()).message}catch(e){console.error("Character response generation failed:",e)}return({friendly:"That's really interesting! I'd love to help you with that. What specific aspect would you like to explore?",professional:"I understand your inquiry. Based on my expertise, I would recommend approaching this systematically.",casual:"Hey, that's cool! Let me think about this for a sec... what's your take on it?",enthusiastic:"Wow, that's fantastic! I'm excited to dive into this with you. There's so much we can explore here!",analytical:"Let me break this down logically. There are several key factors to consider in this situation.",empathetic:"I can sense this is important to you. I'm here to listen and support you through this.",witty:"Ah, an interesting puzzle! You know what they say about these situations... actually, let me think of something clever first.",wise:"In my experience, situations like these often require both patience and perspective. What draws you to this question?"})[t.personality.tone]||"I appreciate you sharing that with me. How can I help you explore this further?"},ex=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),eb=[{id:"home",label:"Home",icon:u.A,href:"/home"},{id:"activity",label:"Activity",icon:h.A,href:"/activity"},{id:"chat",label:"Chat",icon:m.A,href:"/chat",active:!0},{id:"calendar",label:"Calendar",icon:p.A,href:"/calendar"},{id:"profile",label:"Profile",icon:f.A,href:"/profile"}],eN=[{title:"Search",icon:v.A,content:(0,r.Y)("div",{className:"p-4",children:(0,r.FD)("div",{className:"relative",children:[(0,r.Y)(v.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),(0,r.Y)(l.p,{placeholder:"Search conversations...",value:j,onChange:e=>L(e.target.value),className:"pl-10"})]})})},{title:"Characters",icon:g.A,content:(0,r.Y)("div",{className:"p-4",children:(0,r.Y)(G,{onCharacterSelect:e=>{$(e),P("character")},selectedCharacterId:B})})},{title:"Files",icon:y.A,content:(0,r.Y)("div",{className:"p-4",children:(0,r.FD)("div",{className:"text-center text-slate-500 py-8",children:[(0,r.Y)(y.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,r.Y)("div",{className:"text-sm",children:"No files uploaded"}),(0,r.FD)(n.$,{size:"sm",className:"mt-2 gap-2",children:[(0,r.Y)(w.A,{className:"w-3 h-3"}),"Upload File"]})]})})},{title:"Recent Chats",icon:m.A,content:(0,r.FD)("div",{className:"p-4",children:[(0,r.FD)("div",{className:"space-y-2 mb-4",children:[(0,r.FD)(n.$,{variant:"regular"===z?"secondary":"ghost",className:"w-full justify-start gap-2",onClick:()=>{P("regular"),$(null)},children:[(0,r.Y)(b,{className:"w-4 h-4"}),"MyAi Assistant"]}),"character"===z&&J&&(0,r.FD)(n.$,{variant:"secondary",className:"w-full justify-start gap-2",children:[(0,r.Y)("span",{className:"text-sm",children:J.avatar||"\uD83E\uDD16"}),J.name]})]}),(0,r.FD)("div",{className:"space-y-2",children:[null==et?void 0:et.slice(0,10).map(e=>{var t,a;let s=e.id===ea,l=(null==(t=e.messages)?void 0:t.length)||0,i=null==(a=e.messages)?void 0:a[e.messages.length-1],o=i?new Date(i.timestamp).toLocaleDateString():new Date(e.createdAt).toLocaleDateString();return(0,r.Y)(n.$,{variant:s&&"regular"===z?"secondary":"ghost",className:"w-full justify-start text-left p-3 h-auto ".concat(s&&"regular"===z?"bg-blue-50 text-blue-700 border border-blue-200":""),onClick:()=>{er(e.id),P("regular"),$(null)},children:(0,r.FD)("div",{className:"flex-1 min-w-0",children:[(0,r.FD)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.Y)("div",{className:"text-sm font-medium truncate",children:e.title||"Untitled Chat"}),(0,r.Y)("div",{className:"text-xs text-slate-500 ml-2 shrink-0",children:l})]}),(0,r.Y)("div",{className:"text-xs text-slate-500 truncate",children:o})]})},e.id)}),et&&0===et.length&&(0,r.FD)("div",{className:"text-center text-slate-500 py-4",children:[(0,r.Y)(m.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,r.Y)("div",{className:"text-sm",children:"No conversations yet"})]})]}),(0,r.Y)("div",{className:"pt-4 border-t mt-4",children:(0,r.FD)(n.$,{onClick:()=>ei(),disabled:eo,className:"w-full gap-2",size:"sm",children:[(0,r.Y)(w.A,{className:"w-4 h-4"}),"New Chat"]})})]})}],eC="regular"===z?(null==Q?void 0:Q.messages)||[]:"character"===z&&W&&W.length>0&&W[0].messages||[],eY="regular"===z?ee:V;return(0,r.FD)("div",{className:"flex h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[(0,r.Y)("div",{className:"".concat(a?"w-80":"w-0"," transition-all duration-300 bg-white/50 backdrop-blur-sm border-r border-slate-200 flex-col overflow-hidden"),children:a&&(0,r.FD)(r.FK,{children:[(0,r.Y)("div",{className:"p-4 border-b border-slate-200",children:(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)("div",{className:"flex items-center gap-3",children:[(0,r.Y)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:(0,r.Y)(N.A,{className:"w-5 h-5 text-white"})}),(0,r.Y)("h1",{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Chat"})]}),(0,r.Y)(n.$,{variant:"ghost",size:"sm",onClick:()=>x(!1),children:(0,r.Y)(C.A,{className:"w-4 h-4"})})]})}),(0,r.Y)(i.F,{className:"flex-1",children:(0,r.Y)("div",{className:"space-y-1",children:eN.map((e,t)=>{let a=e.icon;return(0,r.FD)("div",{className:"border-b border-slate-100 last:border-b-0",children:[(0,r.Y)("div",{className:"p-3 bg-slate-50/50",children:(0,r.FD)("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[(0,r.Y)(a,{className:"w-4 h-4"}),e.title]})}),e.content]},t)})})})]})}),(0,r.FD)("div",{className:"flex-1 flex flex-col",children:[(0,r.Y)("nav",{className:"bg-white/80 backdrop-blur-sm border-b border-slate-200 p-4",children:(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)("div",{className:"flex items-center gap-4",children:[!a&&(0,r.Y)(n.$,{variant:"ghost",size:"sm",onClick:()=>x(!0),children:(0,r.Y)(Y.A,{className:"w-4 h-4"})}),(0,r.FD)("div",{className:"flex items-center gap-3",children:[(0,r.Y)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:(0,r.Y)(N.A,{className:"w-5 h-5 text-white"})}),(0,r.Y)("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"MyAi"}),"character"===z&&J&&(0,r.FD)("div",{className:"flex items-center gap-2 bg-purple-50 px-3 py-1 rounded-full",children:[(0,r.Y)("span",{className:"text-sm",children:J.avatar||"\uD83E\uDD16"}),(0,r.Y)("span",{className:"text-sm font-medium text-purple-700",children:J.name})]})]}),(0,r.Y)("div",{className:"hidden md:flex items-center gap-1",children:eb.map(e=>{let t=e.icon;return(0,r.Y)(T(),{href:e.href,children:(0,r.FD)(n.$,{variant:e.active?"secondary":"ghost",className:"gap-2 ".concat(e.active?"bg-blue-50 text-blue-700":""),children:[(0,r.Y)(t,{className:"w-4 h-4"}),e.label]})},e.id)})})]}),(0,r.FD)("div",{className:"flex items-center gap-3",children:[(0,r.Y)(d.E,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Online"}),(0,r.Y)(n.$,{variant:"ghost",size:"sm",children:(0,r.Y)(k.A,{className:"w-4 h-4"})}),(0,r.Y)("div",{className:"w-8 h-8 bg-slate-200 rounded-full flex items-center justify-center",children:(0,r.Y)(f.A,{className:"w-4 h-4 text-slate-600"})})]})]})}),"regular"===z&&el&&(0,r.Y)("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border-b border-amber-200 p-4",children:(0,r.FD)("div",{className:"max-w-4xl mx-auto",children:[(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)("div",{className:"flex items-center gap-3",children:[(0,r.Y)("div",{className:"w-8 h-8 bg-amber-500 rounded-full flex items-center justify-center",children:(0,r.Y)(m.A,{className:"w-4 h-4 text-white"})}),(0,r.FD)("div",{children:[(0,r.Y)("h3",{className:"font-semibold text-amber-800",children:"Chat Too Long"}),(0,r.FD)("p",{className:"text-sm text-amber-700",children:["Your chat has ",ec," messages (max recommended: ",ed,"). Consider starting a new chat for better performance."]})]})]}),(0,r.Y)(n.$,{onClick:()=>ei(),disabled:eo,className:"bg-amber-600 hover:bg-amber-700 text-white gap-2",children:eo?(0,r.FD)(r.FK,{children:[(0,r.Y)(F.A,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):(0,r.FD)(r.FK,{children:[(0,r.Y)(w.A,{className:"w-4 h-4"}),"New Chat"]})})]}),(0,r.Y)("div",{className:"mt-3 text-xs text-amber-600",children:"A summary of our progress so far will be added automatically to the new chat."})]})}),"regular"===z&&en&&(0,r.Y)("div",{className:"bg-gradient-to-r from-red-50 to-red-100 border-b border-red-200 p-4",children:(0,r.Y)("div",{className:"max-w-4xl mx-auto",children:(0,r.FD)("div",{className:"flex items-center gap-3",children:[(0,r.Y)("div",{className:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center animate-pulse",children:(0,r.Y)(m.A,{className:"w-4 h-4 text-white"})}),(0,r.FD)("div",{children:[(0,r.Y)("h3",{className:"font-semibold text-red-800",children:"Chat at Maximum Length"}),(0,r.Y)("p",{className:"text-sm text-red-700",children:"This conversation will automatically create a new chat on your next message to maintain performance."})]})]})})}),(0,r.Y)(i.F,{className:"flex-1 p-4",children:(0,r.Y)("div",{className:"space-y-4 max-w-4xl mx-auto",children:eY?(0,r.FD)("div",{className:"flex items-center justify-center h-full",children:[(0,r.Y)(F.A,{className:"w-6 h-6 animate-spin"}),(0,r.Y)("span",{className:"ml-2",children:"Loading..."})]}):null==eC?void 0:eC.map((e,t)=>(0,r.FD)("div",{className:"flex gap-3 ".concat("user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&(0,r.Y)(c.eu,{className:"w-8 h-8",children:(0,r.Y)(c.q5,{className:"bg-gradient-to-br from-blue-500 to-purple-600 text-white text-sm",children:"character"===z&&J?J.avatar:"AI"})}),(0,r.FD)("div",{className:"max-w-[70%] rounded-2xl px-4 py-3 ".concat("user"===e.role?"bg-blue-500 text-white":"bg-white border border-slate-200"),children:[(0,r.Y)("p",{className:"text-sm leading-relaxed",children:e.content}),(0,r.Y)("div",{className:"text-xs mt-2 ".concat("user"===e.role?"text-blue-100":"text-slate-500"),children:ex(e.timestamp)})]}),"user"===e.role&&(0,r.Y)(c.eu,{className:"w-8 h-8",children:(0,r.Y)(c.q5,{className:"bg-slate-200",children:(0,r.Y)(f.A,{className:"w-4 h-4"})})})]},"".concat(e.timestamp,"-").concat(t)))})}),(0,r.Y)("div",{className:"bg-white/50 backdrop-blur-sm border-t border-slate-200 p-4",children:(0,r.FD)("div",{className:"max-w-4xl mx-auto",children:["regular"===z&&ec>0&&(0,r.FD)("div",{className:"mb-3",children:[(0,r.FD)("div",{className:"flex items-center justify-between text-xs mb-1",children:[(0,r.Y)("span",{className:"text-slate-500",children:"Messages in conversation"}),(0,r.FD)("span",{className:"font-medium ".concat(en?"text-red-600":es?"text-amber-600":"text-slate-600"),children:[ec," / ",ed]})]}),(0,r.Y)("div",{className:"w-full bg-slate-200 rounded-full h-1.5",children:(0,r.Y)("div",{className:"h-1.5 rounded-full transition-all duration-300 ".concat(en?"bg-red-500":es?"bg-amber-500":"bg-blue-500"),style:{width:"".concat(Math.min(ec/ed*100,100),"%")}})})]}),(0,r.FD)("div",{className:"flex gap-3",children:[(0,r.FD)("div",{className:"relative flex-1",children:[(0,r.Y)(o.T,{placeholder:"character"===z&&J?"Chat with ".concat(J.name,"..."):en?"Chat is at maximum length. A new chat will be created automatically.":eu?"Listening... Speak now":"Share your thoughts, experiences, or ask me anything...",value:eu?"".concat(e).concat(em):e,onChange:e=>t(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ey())},className:"min-h-[50px] max-h-[120px] resize-none pr-12",disabled:eu||"regular"===z&&(en||eo)}),eh&&!("regular"===z&&en)&&(0,r.Y)(n.$,{type:"button",variant:"ghost",size:"sm",onClick:ep,className:"absolute right-2 top-2 h-8 w-8 p-0 ".concat(eu?"text-red-500 hover:text-red-600 bg-red-50 hover:bg-red-100":"text-slate-500 hover:text-slate-700"),title:eu?"Stop recording":"Start voice input",children:eu?(0,r.Y)(D,{className:"w-4 h-4 animate-pulse"}):(0,r.Y)(A.A,{className:"w-4 h-4"})})]}),(0,r.Y)(n.$,{onClick:ey,className:"bg-blue-500 hover:bg-blue-600 text-white",size:"icon",disabled:eu||"regular"===z&&(en||eo)||!e.trim()||V,children:eo||V?(0,r.Y)(F.A,{className:"w-4 h-4 animate-spin"}):(0,r.Y)(S,{className:"w-4 h-4"})})]}),(0,r.FD)("div",{className:"flex justify-between items-center mt-2 text-xs text-slate-500",children:[(0,r.FD)("p",{children:["character"===z&&J?"Chatting with ".concat(J.name," - ").concat(J.personality.tone," personality"):"regular"===z&&en?"Next message will create a new chat automatically":"regular"===z&&es?"Consider starting a new chat for better performance":"Press Enter to send, Shift+Enter for new line",eh&&!("regular"===z&&en)&&(0,r.Y)("span",{className:"ml-2",children:"• Click mic for voice input"})]}),(0,r.Y)("p",{children:"character"===z?"AI Character Chat":"MyAi remembers our conversations"})]})]})})]})]})}function Q(){return(0,r.Y)(z.A,{children:(0,r.Y)(Z,{})})}},6941:(e,t,a)=>{Promise.resolve().then(a.bind(a,6880))},8539:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});var r=a(5853),s=a(2115),n=a(9434);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});l.displayName="Textarea"},9053:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(5853),s=a(2115),n=a(5695),l=a(1255),i=a(4601),o=a(172);function c(e){let{children:t}=e,{isAuthenticated:a,isLoading:c}=(0,l.a)(),d=(0,n.useRouter)();return((0,s.useEffect)(()=>{c||a||d.push("/home")},[a,c,d]),c)?(0,r.Y)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-purple-50 flex items-center justify-center",children:(0,r.FD)("div",{className:"text-center",children:[(0,r.FD)("div",{className:"flex items-center justify-center gap-3 mb-4",children:[(0,r.Y)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center",children:(0,r.Y)(i.A,{className:"w-7 h-7 text-white"})}),(0,r.Y)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"MyAi"})]}),(0,r.Y)("p",{className:"text-slate-600 mb-4",children:"Loading your personal companion..."}),(0,r.Y)("div",{className:"flex items-center justify-center",children:(0,r.Y)(o.A,{className:"w-6 h-6 animate-spin text-blue-600"})})]})}):a?(0,r.Y)(r.FK,{children:t}):null}},9409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>h,eb:()=>v,gC:()=>f,l6:()=>d,yv:()=>u});var r=a(5853),s=a(2115),n=a(1461),l=a(9556),i=a(7381),o=a(518),c=a(9434);let d=n.bL;n.YJ;let u=n.WT,h=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,r.FD)(n.l9,{ref:t,className:(0,c.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[s,(0,r.Y)(n.In,{asChild:!0,children:(0,r.Y)(l.A,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=n.l9.displayName;let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.PP,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.Y)(i.A,{className:"h-4 w-4"})})});m.displayName=n.PP.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.wn,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.Y)(l.A,{className:"h-4 w-4"})})});p.displayName=n.wn.displayName;let f=s.forwardRef((e,t)=>{let{className:a,children:s,position:l="popper",...i}=e;return(0,r.Y)(n.ZL,{children:(0,r.FD)(n.UC,{ref:t,className:(0,c.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...i,children:[(0,r.Y)(m,{}),(0,r.Y)(n.LM,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.Y)(p,{})]})})});f.displayName=n.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.JU,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",a),...s})}).displayName=n.JU.displayName;let v=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.FD)(n.q7,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.Y)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.Y)(n.VF,{children:(0,r.Y)(o.A,{className:"h-4 w-4"})})}),(0,r.Y)(n.p4,{children:s})]})});v.displayName=n.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.wv,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=n.wv.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[853,273,935,895,655,396,420,441,684,358],()=>t(6941)),_N_E=e.O()}]);