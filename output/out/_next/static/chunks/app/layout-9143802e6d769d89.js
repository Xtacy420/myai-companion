(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{6:(e,t,a)=>{"use strict";a.d(t,{default:()=>n});var r=a(5853),s=a(2115),i=a(2956);function n(e){let{children:t}=e,[a,n]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{try{await i.EC.initialize(),n(!0)}catch(e){console.error("Failed to initialize local database:",e),c(e instanceof Error?e.message:"Database initialization failed")}})()},[]),a)?(0,r.Y)(r.FK,{children:t}):(0,r.Y)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-purple-50 flex items-center justify-center",children:(0,r.FD)("div",{className:"text-center",children:[(0,r.Y)("h1",{className:"text-3xl font-bold text-slate-800 mb-4",children:"MyAi - Personal Memory Companion"}),d?(0,r.FD)(r.FK,{children:[(0,r.FD)("p",{className:"text-red-600 mb-4",children:["Database Error: ",d]}),(0,r.Y)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]}):(0,r.FD)(r.FK,{children:[(0,r.Y)("p",{className:"text-slate-600 mb-4",children:"Initializing local database..."}),(0,r.Y)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})]})]})})}},347:()=>{},477:()=>{},2374:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{cancelIdleCallback:function(){return r},requestIdleCallback:function(){return a}});let a="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},r="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},2714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"setAttributesFromProps",{enumerable:!0,get:function(){return i}});let a={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",noModule:"noModule"},r=["onLoad","onReady","dangerouslySetInnerHTML","children","onError","strategy","stylesheets"];function s(e){return["async","defer","noModule"].includes(e)}function i(e,t){for(let[i,n]of Object.entries(t)){if(!t.hasOwnProperty(i)||r.includes(i)||void 0===n)continue;let d=a[i]||i.toLowerCase();"SCRIPT"===e.tagName&&s(d)?e[d]=!!n:e.setAttribute(d,String(n)),(!1===n||"SCRIPT"===e.tagName&&s(d)&&(!n||"false"===n))&&(e.setAttribute(d,""),e.removeAttribute(d))}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},2956:(e,t,a)=>{"use strict";a.d(t,{EC:()=>o});var r=a(5),s=a(2109),i=a.n(s);let n=a(9509).env.NEXT_PUBLIC_DB_ENCRYPTION_KEY||"myai-default-key-change-in-production";class d extends r.Ay{constructor(){super("MyAiDB"),this.version(1).stores({users:"id, email, createdAt, lastActiveAt",conversations:"id, userId, title, createdAt, updatedAt",characters:"id, userId, name, isActive, createdAt, updatedAt",characterConversations:"id, userId, characterId, title, createdAt, updatedAt",memory:"id, userId, type, importance, createdAt, updatedAt",checkIns:"id, userId, date, mood, createdAt",family:"id, userId, name, relationship, birthday, createdAt, updatedAt",reminders:"id, userId, title, dueDate, priority, status, createdAt, completedAt",customCalendars:"id, userId, name, category, isDefault, isVisible, createdAt, updatedAt",events:"id, userId, calendarId, title, startDate, endDate, type, status, priority, createdAt, updatedAt",lifeTemplates:"id, userId, name, category, isActive, createdAt, updatedAt",emotions:"id, userId, name, intensity, timestamp, checkInId"})}}class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}async initialize(){if(!this.isInitialized)try{await this.db.open(),this.isInitialized=!0,console.log("Local database initialized successfully")}catch(e){throw console.error("Failed to initialize database:",e),e}}async saveToStorage(){return Promise.resolve()}async createUser(e){let t={id:this.generateUserId(),createdAt:Date.now(),...e};return await this.db.users.add(t),t}async getUserById(e){return await this.db.users.get(e)}async getUserByEmail(e){return await this.db.users.where("email").equals(e).first()}async updateUser(e,t){await this.db.users.update(e,t)}async deleteUser(e){await this.db.users.delete(e)}async createConversation(e){await this.db.conversations.add(e)}async getConversationById(e){return await this.db.conversations.get(e)}async getConversationsByUser(e){return(await this.db.conversations.where("userId").equals(e).toArray()).sort((e,t)=>t.updatedAt-e.updatedAt)}async updateConversation(e,t){await this.db.conversations.update(e,t)}async deleteConversation(e){await this.db.conversations.delete(e)}async searchConversations(e,t){return(await this.getConversationsByUser(e)).filter(e=>e.title.toLowerCase().includes(t.toLowerCase())||e.messages.some(e=>e.content.toLowerCase().includes(t.toLowerCase())))}async createCharacter(e){await this.db.characters.add(e)}async getCharacterById(e){return await this.db.characters.get(e)}async getCharactersByUser(e){return await this.db.characters.where("userId").equals(e).reverse().sortBy("createdAt")}async updateCharacter(e,t){await this.db.characters.update(e,t)}async deleteCharacter(e){await this.db.characterConversations.where("characterId").equals(e).delete(),await this.db.characters.delete(e)}async createCharacterConversation(e){await this.db.characterConversations.add(e)}async getCharacterConversationById(e){return await this.db.characterConversations.get(e)}async getCharacterConversations(e){return await this.db.characterConversations.where("characterId").equals(e).reverse().sortBy("updatedAt")}async updateCharacterConversation(e,t){await this.db.characterConversations.update(e,t)}async deleteCharacterConversation(e){await this.db.characterConversations.delete(e)}async createMemory(e){await this.db.memory.add(e)}async getMemoryById(e){return await this.db.memory.get(e)}async getMemoriesByUser(e){return await this.db.memory.where("userId").equals(e).reverse().sortBy("createdAt")}async updateMemory(e,t){await this.db.memory.update(e,t)}async deleteMemory(e){await this.db.memory.delete(e)}async searchMemories(e,t){return(await this.getMemoriesByUser(e)).filter(e=>e.content.toLowerCase().includes(t.toLowerCase())||e.summary.toLowerCase().includes(t.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(t.toLowerCase())))}async createCheckIn(e){await this.db.checkIns.add(e)}async getCheckInById(e){return await this.db.checkIns.get(e)}async getCheckInsByUser(e,t){let a=await this.db.checkIns.where("userId").equals(e).reverse().sortBy("date");return t?a.slice(0,t):a}async updateCheckIn(e,t){await this.db.checkIns.update(e,t)}async deleteCheckIn(e){await this.db.checkIns.delete(e)}async createFamilyMember(e){await this.db.family.add(e)}async getFamilyMemberById(e){return await this.db.family.get(e)}async getFamilyMembersByUser(e){return await this.db.family.where("userId").equals(e).sortBy("name")}async updateFamilyMember(e,t){await this.db.family.update(e,t)}async deleteFamilyMember(e){await this.db.family.delete(e)}generateUserId(){return"user_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}generateId(){return"".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}async exportDatabase(){let e={users:await this.db.users.toArray(),conversations:await this.db.conversations.toArray(),characters:await this.db.characters.toArray(),characterConversations:await this.db.characterConversations.toArray(),memory:await this.db.memory.toArray(),checkIns:await this.db.checkIns.toArray(),family:await this.db.family.toArray(),reminders:await this.db.reminders.toArray(),customCalendars:await this.db.customCalendars.toArray(),events:await this.db.events.toArray(),lifeTemplates:await this.db.lifeTemplates.toArray(),emotions:await this.db.emotions.toArray()};return this.encrypt(JSON.stringify(e))}async importDatabase(e){try{let t=JSON.parse(this.decrypt(e));await this.clearDatabase(),t.users&&await this.db.users.bulkAdd(t.users),t.conversations&&await this.db.conversations.bulkAdd(t.conversations),t.characters&&await this.db.characters.bulkAdd(t.characters),t.characterConversations&&await this.db.characterConversations.bulkAdd(t.characterConversations),t.memory&&await this.db.memory.bulkAdd(t.memory),t.checkIns&&await this.db.checkIns.bulkAdd(t.checkIns),t.family&&await this.db.family.bulkAdd(t.family),t.reminders&&await this.db.reminders.bulkAdd(t.reminders),t.customCalendars&&await this.db.customCalendars.bulkAdd(t.customCalendars),t.events&&await this.db.events.bulkAdd(t.events),t.lifeTemplates&&await this.db.lifeTemplates.bulkAdd(t.lifeTemplates),t.emotions&&await this.db.emotions.bulkAdd(t.emotions),console.log("Database imported successfully")}catch(e){throw console.error("Failed to import database:",e),e}}async clearDatabase(){await this.db.users.clear(),await this.db.conversations.clear(),await this.db.characters.clear(),await this.db.characterConversations.clear(),await this.db.memory.clear(),await this.db.checkIns.clear(),await this.db.family.clear(),await this.db.reminders.clear(),await this.db.customCalendars.clear(),await this.db.events.clear(),await this.db.lifeTemplates.clear(),await this.db.emotions.clear()}encrypt(e){return i().AES.encrypt(e,n).toString()}decrypt(e){return i().AES.decrypt(e,n).toString(i().enc.Utf8)}getDatabaseSize(){return"Local Storage"}constructor(){this.isInitialized=!1,this.db=new d}}let o=c.getInstance()},4147:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_5cfdac",variable:"__variable_5cfdac"}},8489:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}},9243:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return p},handleClientScriptLoad:function(){return f},initScriptLoader:function(){return m}});let r=a(8229),s=a(6966),i=a(5155),n=r._(a(7650)),d=s._(a(2115)),c=a(2830),o=a(2714),l=a(2374),u=new Map,h=new Set,y=e=>{if(n.default.preinit)return void e.forEach(e=>{n.default.preinit(e,{as:"style"})});{let t=document.head;e.forEach(e=>{let a=document.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=e,t.appendChild(a)})}},b=e=>{let{src:t,id:a,onLoad:r=()=>{},onReady:s=null,dangerouslySetInnerHTML:i,children:n="",strategy:d="afterInteractive",onError:c,stylesheets:l}=e,b=a||t;if(b&&h.has(b))return;if(u.has(t)){h.add(b),u.get(t).then(r,c);return}let f=()=>{s&&s(),h.add(b)},m=document.createElement("script"),w=new Promise((e,t)=>{m.addEventListener("load",function(t){e(),r&&r.call(this,t),f()}),m.addEventListener("error",function(e){t(e)})}).catch(function(e){c&&c(e)});i?(m.innerHTML=i.__html||"",f()):n?(m.textContent="string"==typeof n?n:Array.isArray(n)?n.join(""):"",f()):t&&(m.src=t,u.set(t,w)),(0,o.setAttributesFromProps)(m,e),"worker"===d&&m.setAttribute("type","text/partytown"),m.setAttribute("data-nscript",d),l&&y(l),document.body.appendChild(m)};function f(e){let{strategy:t="afterInteractive"}=e;"lazyOnload"===t?window.addEventListener("load",()=>{(0,l.requestIdleCallback)(()=>b(e))}):b(e)}function m(e){e.forEach(f),[...document.querySelectorAll('[data-nscript="beforeInteractive"]'),...document.querySelectorAll('[data-nscript="beforePageRender"]')].forEach(e=>{let t=e.id||e.getAttribute("src");h.add(t)})}function w(e){let{id:t,src:a="",onLoad:r=()=>{},onReady:s=null,strategy:o="afterInteractive",onError:u,stylesheets:y,...f}=e,{updateScripts:m,scripts:w,getIsSsr:p,appDir:v,nonce:g}=(0,d.useContext)(c.HeadManagerContext),C=(0,d.useRef)(!1);(0,d.useEffect)(()=>{let e=t||a;C.current||(s&&e&&h.has(e)&&s(),C.current=!0)},[s,t,a]);let I=(0,d.useRef)(!1);if((0,d.useEffect)(()=>{if(!I.current){if("afterInteractive"===o)b(e);else"lazyOnload"===o&&("complete"===document.readyState?(0,l.requestIdleCallback)(()=>b(e)):window.addEventListener("load",()=>{(0,l.requestIdleCallback)(()=>b(e))}));I.current=!0}},[e,o]),("beforeInteractive"===o||"worker"===o)&&(m?(w[o]=(w[o]||[]).concat([{id:t,src:a,onLoad:r,onReady:s,onError:u,...f}]),m(w)):p&&p()?h.add(t||a):p&&!p()&&b(e)),v){if(y&&y.forEach(e=>{n.default.preinit(e,{as:"style"})}),"beforeInteractive"===o)if(!a)return f.dangerouslySetInnerHTML&&(f.children=f.dangerouslySetInnerHTML.__html,delete f.dangerouslySetInnerHTML),(0,i.jsx)("script",{nonce:g,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([0,{...f,id:t}])+")"}});else return n.default.preload(a,f.integrity?{as:"script",integrity:f.integrity,nonce:g,crossOrigin:f.crossOrigin}:{as:"script",nonce:g,crossOrigin:f.crossOrigin}),(0,i.jsx)("script",{nonce:g,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([a,{...f,id:t}])+")"}});"afterInteractive"===o&&a&&n.default.preload(a,f.integrity?{as:"script",integrity:f.integrity,nonce:g,crossOrigin:f.crossOrigin}:{as:"script",nonce:g,crossOrigin:f.crossOrigin})}return null}Object.defineProperty(w,"__nextScript",{value:!0});let p=w;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9757:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,9243,23)),Promise.resolve().then(a.t.bind(a,4147,23)),Promise.resolve().then(a.t.bind(a,8489,23)),Promise.resolve().then(a.bind(a,6)),Promise.resolve().then(a.t.bind(a,347,23))}},e=>{var t=t=>e(e.s=t);e.O(0,[896,853,273,441,684,358],()=>t(9757)),_N_E=e.O()}]);