(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[420],{285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var a=r(5853),s=r(2115),i=r(9708),n=r(2085),c=r(9434);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:d=!1,...l}=e,u=d?i.DX:"button";return(0,a.Y)(u,{className:(0,c.cn)(o({variant:s,size:n,className:r})),ref:t,...l})});d.displayName="Button"},477:()=>{},1255:(e,t,r)=>{"use strict";r.d(t,{a:()=>c});var a=r(2115),s=r(2956);class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}async createUser(e){return await s.EC.createUser(e)}async getUserById(e){return await s.EC.getUserById(e)||null}async getUserByEmail(e){return await s.EC.getUserByEmail(e)||null}async updateUser(e,t){await s.EC.updateUser(e,t)}async updateLastActive(e){await s.EC.updateUser(e,{lastActiveAt:Date.now()})}async deleteUser(e){await s.EC.deleteUser(e)}async getAllUsers(){return[]}generateUserId(){return"user_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}async authenticateUser(e,t){let r=await this.getUserByEmail(e);return r?(await this.updateLastActive(r.id),r):null}async registerUser(e,t,r){if(await this.getUserByEmail(e))throw Error("User already exists with this email");return await this.createUser({email:e,name:r,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})}setCurrentUser(e){localStorage.setItem("myai-current-user",JSON.stringify(e))}getCurrentUser(){let e=localStorage.getItem("myai-current-user");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}clearCurrentUser(){localStorage.removeItem("myai-current-user")}isAuthenticated(){return null!==this.getCurrentUser()}constructor(){}}let n=i.getInstance();function c(){let[e,t]=(0,a.useState)(null),[r,i]=(0,a.useState)(!0),[c,o]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{await s.EC.initialize();let e=n.getCurrentUser();e&&(t(e),o(!0),await n.updateLastActive(e.id))}catch(e){console.error("Failed to initialize user:",e)}finally{i(!1)}})()},[]);let d=(0,a.useCallback)(async(e,r)=>{try{i(!0);let a=await n.authenticateUser(e,r);if(!a)return{success:!1,error:"Invalid email or password"};return t(a),o(!0),n.setCurrentUser(a),{success:!0}}catch(e){return console.error("Sign in error:",e),{success:!1,error:e instanceof Error?e.message:"Sign in failed"}}finally{i(!1)}},[]),l=(0,a.useCallback)(async(e,r,a)=>{try{i(!0);let s=await n.registerUser(e,r,a);return t(s),o(!0),n.setCurrentUser(s),{success:!0}}catch(e){return console.error("Sign up error:",e),{success:!1,error:e instanceof Error?e.message:"Sign up failed"}}finally{i(!1)}},[]),u=(0,a.useCallback)(async()=>{try{return n.clearCurrentUser(),t(null),o(!1),{success:!0}}catch(e){return console.error("Sign out error:",e),{success:!1,error:e instanceof Error?e.message:"Sign out failed"}}},[]),h=(0,a.useCallback)(async r=>{if(!e)return{success:!1,error:"No user logged in"};try{await n.updateUser(e.id,r);let a={...e,...r};return t(a),n.setCurrentUser(a),{success:!0}}catch(e){return console.error("Update user error:",e),{success:!1,error:e instanceof Error?e.message:"Update failed"}}},[e]),y=(0,a.useCallback)(async r=>{if(!e)return{success:!1,error:"No user logged in"};try{await n.updateUser(e.id,r);let a={...e,...r};return t(a),n.setCurrentUser(a),{success:!0}}catch(e){return console.error("Create user profile error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to create user profile"}}},[e]),m=(0,a.useCallback)(async()=>{if(e)try{await n.updateLastActive(e.id);let r={...e,lastActiveAt:Date.now()};t(r),n.setCurrentUser(r)}catch(e){console.error("Update last active error:",e)}},[e]),b=(0,a.useCallback)(async()=>{if(!e)return{success:!1,error:"No user logged in"};try{return await s.EC.clearDatabase(),await n.deleteUser(e.id),n.clearCurrentUser(),t(null),o(!1),{success:!0}}catch(e){return console.error("Delete account error:",e),{success:!1,error:e instanceof Error?e.message:"Account deletion failed"}}},[e]),w=(0,a.useCallback)(async()=>{if(!e)throw Error("No user logged in");try{let t=await s.EC.exportDatabase(),r={version:"1.0",user:e,database:t,exportedAt:Date.now()};return JSON.stringify(r)}catch(e){throw console.error("Export user data error:",e),e}},[e]),f=(0,a.useCallback)(async e=>{try{let r=JSON.parse(e);if(!r.database||!r.user)throw Error("Invalid backup format");return await s.EC.importDatabase(r.database),t(r.user),o(!0),n.setCurrentUser(r.user),{success:!0}}catch(e){return console.error("Import user data error:",e),{success:!1,error:e instanceof Error?e.message:"Import failed"}}},[]),g=(0,a.useCallback)(()=>s.EC.getDatabaseSize(),[]),p=(null==e?void 0:e.id)||null;return{user:e,userId:p,isAuthenticated:c,isLoading:r,signIn:d,signUp:l,signOut:u,updateUser:h,createUserProfile:y,markUserActive:m,deleteAccount:b,exportUserData:w,importUserData:f,getDatabaseSize:g}}},2523:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var a=r(5853),s=r(2115),i=r(9434);let n=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.Y)("input",{type:s,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});n.displayName="Input"},2956:(e,t,r)=>{"use strict";r.d(t,{EC:()=>d});var a=r(5),s=r(2109),i=r.n(s);let n=r(9509).env.NEXT_PUBLIC_DB_ENCRYPTION_KEY||"myai-default-key-change-in-production";class c extends a.Ay{constructor(){super("MyAiDB"),this.version(1).stores({users:"id, email, createdAt, lastActiveAt",conversations:"id, userId, title, createdAt, updatedAt",characters:"id, userId, name, isActive, createdAt, updatedAt",characterConversations:"id, userId, characterId, title, createdAt, updatedAt",memory:"id, userId, type, importance, createdAt, updatedAt",checkIns:"id, userId, date, mood, createdAt",family:"id, userId, name, relationship, birthday, createdAt, updatedAt",reminders:"id, userId, title, dueDate, priority, status, createdAt, completedAt",customCalendars:"id, userId, name, category, isDefault, isVisible, createdAt, updatedAt",events:"id, userId, calendarId, title, startDate, endDate, type, status, priority, createdAt, updatedAt",lifeTemplates:"id, userId, name, category, isActive, createdAt, updatedAt",emotions:"id, userId, name, intensity, timestamp, checkInId"})}}class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}async initialize(){if(!this.isInitialized)try{await this.db.open(),this.isInitialized=!0,console.log("Local database initialized successfully")}catch(e){throw console.error("Failed to initialize database:",e),e}}async saveToStorage(){return Promise.resolve()}async createUser(e){let t={id:this.generateUserId(),createdAt:Date.now(),...e};return await this.db.users.add(t),t}async getUserById(e){return await this.db.users.get(e)}async getUserByEmail(e){return await this.db.users.where("email").equals(e).first()}async updateUser(e,t){await this.db.users.update(e,t)}async deleteUser(e){await this.db.users.delete(e)}async createConversation(e){await this.db.conversations.add(e)}async getConversationById(e){return await this.db.conversations.get(e)}async getConversationsByUser(e){return(await this.db.conversations.where("userId").equals(e).toArray()).sort((e,t)=>t.updatedAt-e.updatedAt)}async updateConversation(e,t){await this.db.conversations.update(e,t)}async deleteConversation(e){await this.db.conversations.delete(e)}async searchConversations(e,t){return(await this.getConversationsByUser(e)).filter(e=>e.title.toLowerCase().includes(t.toLowerCase())||e.messages.some(e=>e.content.toLowerCase().includes(t.toLowerCase())))}async createCharacter(e){await this.db.characters.add(e)}async getCharacterById(e){return await this.db.characters.get(e)}async getCharactersByUser(e){return await this.db.characters.where("userId").equals(e).reverse().sortBy("createdAt")}async updateCharacter(e,t){await this.db.characters.update(e,t)}async deleteCharacter(e){await this.db.characterConversations.where("characterId").equals(e).delete(),await this.db.characters.delete(e)}async createCharacterConversation(e){await this.db.characterConversations.add(e)}async getCharacterConversationById(e){return await this.db.characterConversations.get(e)}async getCharacterConversations(e){return await this.db.characterConversations.where("characterId").equals(e).reverse().sortBy("updatedAt")}async updateCharacterConversation(e,t){await this.db.characterConversations.update(e,t)}async deleteCharacterConversation(e){await this.db.characterConversations.delete(e)}async createMemory(e){await this.db.memory.add(e)}async getMemoryById(e){return await this.db.memory.get(e)}async getMemoriesByUser(e){return await this.db.memory.where("userId").equals(e).reverse().sortBy("createdAt")}async updateMemory(e,t){await this.db.memory.update(e,t)}async deleteMemory(e){await this.db.memory.delete(e)}async searchMemories(e,t){return(await this.getMemoriesByUser(e)).filter(e=>e.content.toLowerCase().includes(t.toLowerCase())||e.summary.toLowerCase().includes(t.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(t.toLowerCase())))}async createCheckIn(e){await this.db.checkIns.add(e)}async getCheckInById(e){return await this.db.checkIns.get(e)}async getCheckInsByUser(e,t){let r=await this.db.checkIns.where("userId").equals(e).reverse().sortBy("date");return t?r.slice(0,t):r}async updateCheckIn(e,t){await this.db.checkIns.update(e,t)}async deleteCheckIn(e){await this.db.checkIns.delete(e)}async createFamilyMember(e){await this.db.family.add(e)}async getFamilyMemberById(e){return await this.db.family.get(e)}async getFamilyMembersByUser(e){return await this.db.family.where("userId").equals(e).sortBy("name")}async updateFamilyMember(e,t){await this.db.family.update(e,t)}async deleteFamilyMember(e){await this.db.family.delete(e)}generateUserId(){return"user_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}generateId(){return"".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}async exportDatabase(){let e={users:await this.db.users.toArray(),conversations:await this.db.conversations.toArray(),characters:await this.db.characters.toArray(),characterConversations:await this.db.characterConversations.toArray(),memory:await this.db.memory.toArray(),checkIns:await this.db.checkIns.toArray(),family:await this.db.family.toArray(),reminders:await this.db.reminders.toArray(),customCalendars:await this.db.customCalendars.toArray(),events:await this.db.events.toArray(),lifeTemplates:await this.db.lifeTemplates.toArray(),emotions:await this.db.emotions.toArray()};return this.encrypt(JSON.stringify(e))}async importDatabase(e){try{let t=JSON.parse(this.decrypt(e));await this.clearDatabase(),t.users&&await this.db.users.bulkAdd(t.users),t.conversations&&await this.db.conversations.bulkAdd(t.conversations),t.characters&&await this.db.characters.bulkAdd(t.characters),t.characterConversations&&await this.db.characterConversations.bulkAdd(t.characterConversations),t.memory&&await this.db.memory.bulkAdd(t.memory),t.checkIns&&await this.db.checkIns.bulkAdd(t.checkIns),t.family&&await this.db.family.bulkAdd(t.family),t.reminders&&await this.db.reminders.bulkAdd(t.reminders),t.customCalendars&&await this.db.customCalendars.bulkAdd(t.customCalendars),t.events&&await this.db.events.bulkAdd(t.events),t.lifeTemplates&&await this.db.lifeTemplates.bulkAdd(t.lifeTemplates),t.emotions&&await this.db.emotions.bulkAdd(t.emotions),console.log("Database imported successfully")}catch(e){throw console.error("Failed to import database:",e),e}}async clearDatabase(){await this.db.users.clear(),await this.db.conversations.clear(),await this.db.characters.clear(),await this.db.characterConversations.clear(),await this.db.memory.clear(),await this.db.checkIns.clear(),await this.db.family.clear(),await this.db.reminders.clear(),await this.db.customCalendars.clear(),await this.db.events.clear(),await this.db.lifeTemplates.clear(),await this.db.emotions.clear()}encrypt(e){return i().AES.encrypt(e,n).toString()}decrypt(e){return i().AES.decrypt(e,n).toString(i().enc.Utf8)}getDatabaseSize(){return"Local Storage"}constructor(){this.isInitialized=!1,this.db=new c}}let d=o.getInstance()},5057:(e,t,r)=>{"use strict";r.d(t,{J:()=>d});var a=r(5853),s=r(2115),i=r(968),n=r(2085),c=r(9434);let o=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.Y)(i.b,{ref:t,className:(0,c.cn)(o(),r),...s})});d.displayName=i.b.displayName},6126:(e,t,r)=>{"use strict";r.d(t,{E:()=>c});var a=r(5853),s=r(2085),i=r(9434);let n=(0,s.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:r,...s}=e;return(0,a.Y)("div",{className:(0,i.cn)(n({variant:r}),t),...s})}},6695:(e,t,r)=>{"use strict";r.d(t,{Wu:()=>d,ZB:()=>o,Zp:()=>n,aR:()=>c});var a=r(5853),s=r(2115),i=r(9434);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.Y)("div",{ref:t,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});n.displayName="Card";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.Y)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...s})});c.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.Y)("div",{ref:t,className:(0,i.cn)("font-semibold leading-none tracking-tight",r),...s})});o.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.Y)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.Y)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.Y)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var a=r(2596),s=r(9688);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}}}]);